# Патчи (Patches)

При каждом запуске **лаунчера** (InfoBot Manager) выполняется механизм патчей: проверяется список ещё не применённых патчей из папки `patches/patches/`, каждый такой патч запускается один раз. Результат сохраняется в `launcher/.patches_applied.json`, чтобы не применять один и тот же патч повторно.

## Зачем

- **Обратная совместимость:** у пользователей со старыми копиями конфигов (например, без классов `DefaultBotConfig`, `SystemConfig` и т.д.) после обновления кода и запуска лаунчера конфиг автоматически дополняется недостающими блоками.
- **Обновление системы:** при необходимости можно добавлять новые патчи (002_, 003_…), которые один раз выполняют миграции или правки при обновлении с репозитория.

## Как добавить новый патч

1. Создайте файл в `patches/patches/` с именем вида `002_краткое_описание.py`.
2. В модуле должна быть функция **`apply(project_root: Path) -> bool`**:
   - `project_root` — корень проекта (каталог с `configs/`, `launcher/` и т.д.);
   - возврат `True` — патч применён (или уже не нужен), его ID добавят в «применённые» и больше вызывать не будут;
   - возврат `False` — патч не применён (например, условия не выполнены), при следующем запуске лаунчера он будет вызван снова.
3. Имя файла без расширения (например, `002_migration_foo`) используется как ID патча в `launcher/.patches_applied.json`.

## Пример

```python
# patches/patches/002_example.py
from pathlib import Path

def apply(project_root: Path) -> bool:
    target = project_root / "configs" / "some_file.py"
    if not target.exists():
        return False
    # ... правка ...
    return True
```
