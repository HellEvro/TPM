# üìä –ê–Ω–∞–ª–∏–∑ bots.py - –ü–ª–∞–Ω —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è

–¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä: **7691 —Å—Ç—Ä–æ–∫–∞**

---

## üîç –ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ bots.py

### 1. –ò–º–ø–æ—Ä—Ç—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (~250 —Å—Ç—Ä–æ–∫)
- –ò–º–ø–æ—Ä—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫
- –ò–º–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª–µ–π
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (RSI_OVERSOLD, EMA_FAST, BOT_STATUS, –∏ —Ç.–¥.)
- **–ù–ï–õ–¨–ó–Ø –≤—ã–Ω–µ—Å—Ç–∏** - –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### 2. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (~50 —Å—Ç—Ä–æ–∫)
```python
exchange = None
bots_data = {}
coins_rsi_data = {}
rsi_data_lock = threading.Lock()
# ... –µ—â–µ ~10 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```
**–ú–û–ñ–ù–û –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:** `state = BotSystemState(exchange)`  
**–≠–∫–æ–Ω–æ–º–∏—è:** ~50 —Å—Ç—Ä–æ–∫ ‚Üí ~5 —Å—Ç—Ä–æ–∫ = **-45 —Å—Ç—Ä–æ–∫**

### 3. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (~500 —Å—Ç—Ä–æ–∫)
–£–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–Ω–µ—Å–µ–Ω—ã:
- ‚úÖ calculate_rsi, calculate_ema ‚Üí —É–∂–µ –≤ bot_engine/utils/
- ‚úÖ check_rsi_time_filter ‚Üí —É–∂–µ –≤ bot_engine/filters.py
- ‚úÖ check_coin_maturity ‚Üí —É–∂–µ –≤ bot_engine/maturity_checker.py

–ú–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
- `load_all_coins_rsi` (~200 —Å—Ç—Ä–æ–∫) ‚Üí bot_engine/rsi_loader.py
- `sync_positions_with_exchange` (~150 —Å—Ç—Ä–æ–∫) ‚Üí bot_engine/position_sync.py
- `compare_positions` (~100 —Å—Ç—Ä–æ–∫) ‚Üí bot_engine/position_sync.py

**–≠–∫–æ–Ω–æ–º–∏—è:** ~450 —Å—Ç—Ä–æ–∫

### 4. –ö–ª–∞—Å—Å NewTradingBot (~500 —Å—Ç—Ä–æ–∫)
```python
class NewTradingBot:
    def __init__(self, symbol, config=None, exchange=None):
        ...
    def update(self, ...):
        ...
    # ~20 –º–µ—Ç–æ–¥–æ–≤
```

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- A) **–û—Å—Ç–∞–≤–∏—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ BotAdapter ‚úÖ
- B) **–í—ã–Ω–µ—Å—Ç–∏** –≤ `bot_engine/trading_bot_new.py` = **-500 —Å—Ç—Ä–æ–∫**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç B - –≤—ã–Ω–µ—Å—Ç–∏!

### 5. API Endpoints (~2500 —Å—Ç—Ä–æ–∫)
```python
@app.route('/api/bots/list')
def list_bots():
    global bots_data
    ...

# 30+ endpoints –ø–æ 50-100 —Å—Ç—Ä–æ–∫ –∫–∞–∂–¥—ã–π
```

**–ú–û–ñ–ù–û –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:**
```python
# –í bots.py
from bot_engine.api import register_all_endpoints
register_all_endpoints(app, state)
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~2500 —Å—Ç—Ä–æ–∫ ‚Üí ~5 —Å—Ç—Ä–æ–∫ = **-2495 —Å—Ç—Ä–æ–∫**

### 6. –í–æ—Ä–∫–µ—Ä—ã (~300 —Å—Ç—Ä–æ–∫)
```python
def auto_bot_worker():
    global bots_data, exchange
    ...  # ~150 —Å—Ç—Ä–æ–∫

def auto_save_worker():
    ...  # ~50 —Å—Ç—Ä–æ–∫
```

**–ú–û–ñ–ù–û –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:**
```python
# –í bots.py
state.worker_manager.start_worker('auto_bot', auto_bot_worker_func, 60)
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~300 —Å—Ç—Ä–æ–∫ ‚Üí ~10 —Å—Ç—Ä–æ–∫ = **-290 —Å—Ç—Ä–æ–∫**

### 7. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ (~400 —Å—Ç—Ä–æ–∫)
```python
def init_bot_service():
    ... # ~200 —Å—Ç—Ä–æ–∫

def main():
    ... # ~100 —Å—Ç—Ä–æ–∫

if __name__ == '__main__':
    ... # ~100 —Å—Ç—Ä–æ–∫
```

**–ú–û–ñ–ù–û —É–ø—Ä–æ—Å—Ç–∏—Ç—å –¥–æ:**
```python
def main():
    state = BotSystemState(exchange)
    state.initialize()
    app.run(...)
    state.shutdown()
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~400 —Å—Ç—Ä–æ–∫ ‚Üí ~50 —Å—Ç—Ä–æ–∫ = **-350 —Å—Ç—Ä–æ–∫**

### 8. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (~3700 —Å—Ç—Ä–æ–∫)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ (—É–∂–µ –≤ bot_engine/storage.py)
- Mature coins (—É–∂–µ –≤ bot_engine/maturity_checker.py)
- –§–∏–ª—å—Ç—Ä—ã (—É–∂–µ –≤ bot_engine/filters.py)
- –†–∞–∑–ª–∏—á–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

---

## üìä –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–û–ï –°–û–ö–†–ê–©–ï–ù–ò–ï

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°–µ–π—á–∞—Å | –ü–æ—Å–ª–µ | –≠–∫–æ–Ω–æ–º–∏—è |
|-----------|--------|-------|----------|
| –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | 50 | 5 | -45 |
| –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ | 500 | 50 | -450 |
| NewTradingBot | 500 | 0 | -500 |
| API Endpoints | 2500 | 5 | -2495 |
| –í–æ—Ä–∫–µ—Ä—ã | 300 | 10 | -290 |
| –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è | 400 | 50 | -350 |
| **–ò–¢–û–ì–û** | **4250** | **120** | **-4130** |

**–û—Å—Ç–∞–ª—å–Ω–æ–µ:** ~3440 —Å—Ç—Ä–æ–∫ (–Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —É–∂–µ –≤—ã–Ω–µ—Å–µ–Ω—ã)

---

## üéØ –†–ï–ê–õ–ò–°–¢–ò–ß–ù–´–ô –ü–õ–ê–ù

### –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2 —á–∞—Å–∞)
**–¶–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏, –ù–ï —É–¥–∞–ª—è—è —Å—Ç–∞—Ä—ã–π –∫–æ–¥

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ bots.py:
   ```python
   from bot_engine.state_manager import BotSystemState
   state = BotSystemState(exchange)
   ```

2. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (—á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è):
   ```python
   USE_STATE_MANAGER = os.getenv('USE_STATE_MANAGER', 'false') == 'true'
   ```

3. –í endpoints –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:
   ```python
   if USE_STATE_MANAGER:
       # –ù–æ–≤—ã–π –∫–æ–¥ —Å state
   else:
       # –°—Ç–∞—Ä—ã–π –∫–æ–¥ —Å global
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ State Manager —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –°—Ç–∞—Ä—ã–π –∫–æ–¥ —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è
- ‚ö†Ô∏è bots.py –≤—Å–µ –µ—â–µ ~7700 —Å—Ç—Ä–æ–∫

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ (2-3 —á–∞—Å–∞) ‚≠ê **–†–ï–ö–û–ú–ï–ù–î–£–Æ!**
**–¶–µ–ª—å:** –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –Ω–∞ –Ω–æ–≤—ã–π, —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã

**–î–µ–π—Å—Ç–≤–∏—è:**

#### –®–∞–≥ 1: –í—ã–Ω–µ—Å—Ç–∏ NewTradingBot (30 –º–∏–Ω—É—Ç)
```bash
# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
mv NewTradingBot ‚Üí bot_engine/trading_bot_new.py
```
**-500 —Å—Ç—Ä–æ–∫**

#### –®–∞–≥ 2: –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ API endpoints (30 –º–∏–Ω—É—Ç)
```python
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ @app.route(...) –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
# –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
from bot_engine.api import register_all_endpoints
register_all_endpoints(app, state_dict)
```
**-2500 —Å—Ç—Ä–æ–∫**

#### –®–∞–≥ 3: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é (30 –º–∏–Ω—É—Ç)
```python
# –ó–∞–º–µ–Ω–∏—Ç—å init_bot_service() –∏ main()
# –ù–∞ –ø—Ä–æ—Å—Ç–æ–π:
state = BotSystemState(exchange)
state.initialize()
app.run(...)
```
**-350 —Å—Ç—Ä–æ–∫**

#### –®–∞–≥ 4: –í—ã–Ω–µ—Å—Ç–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (30 –º–∏–Ω—É—Ç)
- load_all_coins_rsi ‚Üí bot_engine/rsi_loader.py
- sync_positions ‚Üí bot_engine/position_sync.py
**-450 —Å—Ç—Ä–æ–∫**

**–ò–¢–û–ì–û:** **-3800 —Å—Ç—Ä–æ–∫!**

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** bots.py = **~3900 —Å—Ç—Ä–æ–∫** (–±—ã–ª–æ 7691)

---

### –í–∞—Ä–∏–∞–Ω—Ç C: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (4-6 —á–∞—Å–æ–≤)
**–¶–µ–ª—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –í–∞—Ä–∏–∞–Ω—Ç—É B:**
- –í—ã–Ω–µ—Å—Ç–∏ –í–°–ï —Ñ—É–Ω–∫—Ü–∏–∏ —á—Ç–æ –º–æ–∂–Ω–æ
- –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –∫–æ–¥
- –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –º–∏–Ω–∏–º—É–º –≤ bots.py

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** bots.py = **~500-1000 —Å—Ç—Ä–æ–∫**

---

## üí° –ú–û–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –í–∞—Ä–∏–∞–Ω—Ç B

**–ü–æ—á–µ–º—É:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ (2-3 —á–∞—Å–∞)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏)
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ (—É–±–∏—Ä–∞–µ–º ~3800 —Å—Ç—Ä–æ–∫)
- ‚úÖ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ (–Ω–µ —Ç—Ä–æ–≥–∞–µ–º —Å–ª–æ–∂–Ω—ã–π –∫–æ–¥)

**–ü–ª–∞–Ω:**
1. –í—ã–Ω–µ—Å—Ç–∏ NewTradingBot (500 —Å—Ç—Ä–æ–∫)
2. –£–¥–∞–ª–∏—Ç—å API endpoints, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bot_engine/api (2500 —Å—Ç—Ä–æ–∫)
3. –£–ø—Ä–æ—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é (350 —Å—Ç—Ä–æ–∫)
4. –í—ã–Ω–µ—Å—Ç–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (450 —Å—Ç—Ä–æ–∫)

**–ò—Ç–æ–≥–æ:** bots.py —Å–æ–∫—Ä–∞—Ç–∏—Ç—Å—è —Å 7691 –¥–æ ~3900 —Å—Ç—Ä–æ–∫ (-49%)

---

## üöÄ –ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å –í–∞—Ä–∏–∞–Ω—Ç B?

**–î–∞** ‚Üí –Ω–∞—á–∏–Ω–∞—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!  
**–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç** ‚Üí —Å–∫–∞–∂–∏—Ç–µ –∫–∞–∫–æ–π
