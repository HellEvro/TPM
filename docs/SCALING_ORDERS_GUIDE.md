# üìä –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –ú–ê–°–®–¢–ê–ë–ò–†–£–ï–ú–´–ú –û–†–î–ï–†–ê–ú (–õ–ï–°–ï–ù–ö–ê)

## üéØ –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï

–°–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ (–ª–µ—Å–µ–Ω–∫–∞) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–¥–µ–ª–æ–∫ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –æ–±—ä–µ–º–∞.

---

## ‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `data/auto_bot_config.json`:

```json
{
  "scaling_enabled": false,                    // –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ª–µ—Å–µ–Ω–∫—É
  "scaling_number_of_trades": 0,               // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º)
  "scaling_manual_percentages": [],            // –†—É—á–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã (—Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º)
  "scaling_direction": "both",                 // "long_only", "short_only", "both"
  "scaling_distance_percent": 5,               // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤—Ö–æ–¥–∞–º–∏ –≤ %
  "scaling_min_usdt_per_trade": 5,             // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –≤ USDT –Ω–∞ —Å–¥–µ–ª–∫—É (–ª–∏–º–∏—Ç –±–∏—Ä–∂–∏)
  "scaling_timeout_minutes": 30                // –ú–∏–Ω–∏–º—É–º –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –≤—Ö–æ–¥–∞–º–∏
}
```

---

## ü§ñ –†–ï–ñ–ò–ú–´ –†–ê–ë–û–¢–´

### 1. –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ñ–ò–ú (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```json
{
  "scaling_enabled": true,
  "scaling_number_of_trades": 5,               // –•–æ—á—É 5 —Å–¥–µ–ª–æ–∫
  "scaling_manual_percentages": []             // –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é —Å —É–¥–≤–æ–µ–Ω–∏–µ–º: **1x, 2x, 4x, 8x, 16x**
- –°—É–º–º–∞ –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π: **1+2+4+8+16 = 31**
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 100% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–±—ä–µ–º–∞

**–ü—Ä–∏–º–µ—Ä:**
- –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º: **155 USDT**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫: **5**
- –†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –°–¥–µ–ª–∫–∞ 1 (1x):  3.23% = **5 USDT**
  - –°–¥–µ–ª–∫–∞ 2 (2x):  6.45% = **10 USDT**
  - –°–¥–µ–ª–∫–∞ 3 (4x):  12.90% = **20 USDT**
  - –°–¥–µ–ª–∫–∞ 4 (8x):  25.81% = **40 USDT**
  - –°–¥–µ–ª–∫–∞ 5 (16x): 51.61% = **80 USDT**
  - **–ò–¢–û–ì–û: 100% = 155 USDT** ‚úÖ

---

### 2. –†–£–ß–ù–û–ô –†–ï–ñ–ò–ú (–¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```json
{
  "scaling_enabled": true,
  "scaling_number_of_trades": 0,               // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
  "scaling_manual_percentages": [10, 20, 30, 40]  // –£–∫–∞–∑—ã–≤–∞–µ–º —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –°–∏—Å—Ç–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤–∞—à–∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–æ 100%
- –ü—Ä–∏–º–µ—Ä: [10, 20, 30, 40] ‚Üí —Å—É–º–º–∞ = 100 ‚Üí —É–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ü—Ä–∏–º–µ—Ä:**
- –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º: **100 USDT**
- –†—É—á–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã: **[10, 20, 30, 40]**
- –†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –°–¥–µ–ª–∫–∞ 1: 10% = **10 USDT**
  - –°–¥–µ–ª–∫–∞ 2: 20% = **20 USDT**
  - –°–¥–µ–ª–∫–∞ 3: 30% = **30 USDT**
  - –°–¥–µ–ª–∫–∞ 4: 40% = **40 USDT**
  - **–ò–¢–û–ì–û: 100% = 100 USDT** ‚úÖ

**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ï—Å–ª–∏ –≤—ã —É–∫–∞–∂–µ—Ç–µ [1, 2, 3] (—Å—É–º–º–∞ = 6)
- –°–∏—Å—Ç–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç: [16.67%, 33.33%, 50%]
- –ò—Ç–æ–≥–æ: 100% ‚úÖ

---

## üìä –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï –û–ë–™–ï–ú–´

### üö® –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï –ë–ò–†–ñ–ò: –ú–∏–Ω–∏–º—É–º 5 USDT –Ω–∞ —Å–¥–µ–ª–∫—É

### üìã –¢–∞–±–ª–∏—Ü–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –±–∞–∑–æ–≤—ã—Ö –æ–±—ä–µ–º–æ–≤:

| –°–¥–µ–ª–æ–∫ | –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ | –°—É–º–º–∞ | –ú–∏–Ω–∏–º—É–º USDT | –û–±—â–∏–π –æ–±—ä–µ–º USDT |
|--------|-----------|-------|--------------|------------------|
| 2      | 1+2       | 3     | 15 USDT      | 15 USDT          |
| 3      | 1+2+4     | 7     | 35 USDT      | 35 USDT          |
| 5      | 1+2+4+8+16| 31    | 155 USDT     | 155 USDT         |
| 10     | 1+...+512 | 1023  | 5115 USDT    | 5115 USDT        |

### üí° –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–∏–Ω–∏–º—É–º–∞:

```
min_base_usdt = scaling_min_usdt_per_trade * sum_of_multipliers
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è 5 —Å–¥–µ–ª–æ–∫:**
```
sum_of_multipliers = 1 + 2 + 4 + 8 + 16 = 31
min_base_usdt = 5 USDT * 31 = 155 USDT
```

---

## ‚ö†Ô∏è –ü–†–û–í–ï–†–ö–ê –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚ùå –ï—Å–ª–∏ –±–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω:

**–ü—Ä–∏–º–µ—Ä:**
- –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º: **10 USDT**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫: **5**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **–û–®–ò–ë–ö–ê**

**–°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–Ω–µ—Ç:**
```json
{
  "success": false,
  "error": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –¥–ª—è 5 —Å–¥–µ–ª–æ–∫. –ú–∏–Ω–∏–º—É–º: 155.00 USDT",
  "invalid_levels": [
    "–£—Ä–æ–≤–µ–Ω—å 1 (1x): 0.32 USDT < 5.0 USDT",
    "–£—Ä–æ–≤–µ–Ω—å 2 (2x): 0.65 USDT < 5.0 USDT"
  ],
  "recommendation": {
    "min_base_usdt": 155.00,
    "max_base_usdt": 155.00,
    "min_levels": 2,
    "max_levels": 5
  }
}
```

---

## üîß API –§–£–ù–ö–¶–ò–ò

### 1. `calculate_scaling_for_bot(base_usdt, price, scaling_config)`

**–ê—Ä–≥—É–º–µ–Ω—Ç—ã:**
- `base_usdt` (float): –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –≤ USDT
- `price` (float): –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –º–æ–Ω–µ—Ç—ã
- `scaling_config` (dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–µ—Å–µ–Ω–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'success': True/False,
    'levels': [
        {
            'percent': 3.2258,
            'coins': 0.0001,
            'usdt': 5.0,
            'multiplier': 1
        },
        ...
    ],
    'total_percent': 100.0,
    'total_usdt': 155.0,
    'recommendation': None  # –∏–ª–∏ dict —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
}
```

### 2. `get_scaling_hints(min_usdt_per_trade=5.0)`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏:**
```python
{
    '2_trades': {
        'min_base_usdt': 15.0,
        'total_usdt': 15.0,
        'start_percent': 1,
        'levels': ['1% = 5.00 USDT', '2% = 10.00 USDT']
    },
    '3_trades': {...},
    '5_trades': {...},
    '10_trades': {...}
}
```

---

## üìù –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –ü—Ä–∏–º–µ—Ä 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (5 —Å–¥–µ–ª–æ–∫)

```python
from bot_engine.scaling_calculator import calculate_scaling_for_bot

scaling_config = {
    'scaling_enabled': True,
    'scaling_number_of_trades': 5,
    'scaling_manual_percentages': [],
    'scaling_min_usdt_per_trade': 5.0
}

result = calculate_scaling_for_bot(
    base_usdt=155,
    price=50000,
    scaling_config=scaling_config
)

if result['success']:
    for i, level in enumerate(result['levels']):
        print(f"–°–¥–µ–ª–∫–∞ {i+1}: {level['usdt']:.2f} USDT")
```

### –ü—Ä–∏–º–µ—Ä 2: –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º

```python
scaling_config = {
    'scaling_enabled': True,
    'scaling_number_of_trades': 0,
    'scaling_manual_percentages': [10, 20, 30, 40],
    'scaling_min_usdt_per_trade': 5.0
}

result = calculate_scaling_for_bot(
    base_usdt=100,
    price=50000,
    scaling_config=scaling_config
)
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫

```python
from bot_engine.scaling_calculator import get_scaling_hints

hints = get_scaling_hints(min_usdt_per_trade=5.0)

for key, hint in hints.items():
    num_trades = key.split('_')[0]
    print(f"–î–ª—è {num_trades} —Å–¥–µ–ª–æ–∫ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º {hint['min_base_usdt']} USDT")
```

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ DO:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º** –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–º—ã** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ç–∞–±–ª–∏—Ü—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤** –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚ùå DON'T:
- –ù–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –±–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–¥–µ–ª–æ–∫ (> 10) –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ –∫–æ–º–∏—Å—Å–∏–∏ –±–∏—Ä–∂–∏

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
python test_scaling.py
```

–ò–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:
```bash
python test_scaling_detailed.py
```

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –æ–±—ä–µ–º—É.

**–§–æ—Ä–º—É–ª–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∏–Ω–∏–º—É–º–∞:**
```
min_base_usdt = 5 USDT * (1 + 2 + 4 + ... + 2^(n-1))
```

–ì–¥–µ `n` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫.

---

## ‚úÖ –ò–¢–û–ì–ò

- ‚úÖ **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 100%** –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–±—ä–µ–º–∞
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è** —Å —É–¥–≤–æ–µ–Ω–∏–µ–º
- ‚úÖ **–†—É—á–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã** —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º—É–º–∞** 5 USDT –Ω–∞ —Å–¥–µ–ª–∫—É
- ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –æ–±—ä–µ–º–µ
- ‚úÖ **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

---

## üìÖ –î–ê–¢–ê –°–û–ó–î–ê–ù–ò–Ø: 2025-10-09

