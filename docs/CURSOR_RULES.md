# Правила Cursor для InfoBot

> Эти правила настроены в Cursor (User Rules) и должны соблюдаться при работе с проектом.

---

## 1. Язык

**Все ответы — на русском языке.**

---

## 2. Context7 MCP

Использовать Context7 MCP, когда нужна документация по библиотекам/API, генерация кода, установка или настройка — без явной просьбы пользователя.

---

## 2.5. Лог сессий Cursor

**Файл:** `docs/CURSOR_SESSION_LOG.md`

- После внесения изменений и коммита **обязательно обновлять** этот файл
- Добавить секцию с датой, хешем коммита, описанием проблемы и списком изменений
- Другая копия Cursor при `git pull` сможет прочитать лог и понять контекст без просмотра диффов

---

## 3. Git — авто-коммит и пуш после изменений

### Когда коммитить и пушить

- После любых изменений кода (правки, создание, удаление файлов)
- После исправления ошибок линтера
- После реализации фич
- После рефакторинга
- После изменений конфигурации
- Перед переходом к новой задаче

### Процесс

1. Проверить `git status`
2. Создать коммит через **`scripts/git_commit_push.py`** с осмысленным сообщением
3. Пуш выполняется тем же скриптом

### Сообщения коммитов

- **Обязательно на русском языке**
- Настоящее время: «Добавлена функция», «Исправлена ошибка»
- Конкретно: что изменено и зачем
- Примеры:
  - «Исправление ошибок линтера в модуле аутентификации»
  - «Добавлена страница настроек профиля»
  - «Рефакторинг обработки подключения к БД»

### Когда НЕ коммитить

- Пользователь явно просит не коммитить
- Есть незакоммиченные изменения, которые нужно сначала просмотреть
- Репозиторий в конфликтном состоянии

---

## 4. Git — инициализация репозитория

### Когда инициализировать

- Новый проект с нуля
- В директории нет папки `.git`

### Действия

1. `git init`
2. Создать `.gitignore` (если нет), например:
   - `__pycache__/`, `*.pyc`, `*.pyo`, `*.pyd`
   - `venv/`, `.venv`, `env/`, `.env`
   - `*.log`, `.idea/`, `.vscode/`, `node_modules/`

---

## 5. Git Push по команде «пуш», «gei», «push»

При фразах «пуш», «gei» или «push»:

1. `git status`
2. Запустить `scripts/git_commit_push.py "сообщение коммита"` — коммит и пуш
3. Подтвердить успешное выполнение

### Важно

- Не использовать `git commit -a` без явной просьбы
- Не добавлять в коммиты `Co-authored-by: Cursor <...>`
- Коммиты с сообщениями на русском

---

## 6. Чеклист перед коммитом (Code Review)

### 1. Синтаксис и линтер

- Запустить `read_lints` для изменённых файлов
- Исправить ошибки линтера

### 2. Логика

- Все используемые переменные должны быть объявлены
- Проверить импорты
- Нет лишних переменных в `del` и подобных операциях

### 3. Использование

- Найти все места использования изменённого кода (grep, поиск)
- Убедиться, что изменения не ломают другие части кода

### 4. Краевые случаи

- Что, если переменная не определена?
- Что, если функция вызывается в другом контексте?
- Есть ли обработка исключений?

### 5. Тесты

- Запустить существующие тесты
- Проверить работу изменённых функций
- Проверить обработку ошибок

**Коммитить только после проверки.**

---

## 7. Типичные ошибки

- `del variable` при отсутствующей переменной → использовать проверку или `try/except`
- Использование переменной до объявления → проверить порядок выполнения
- Импорт несуществующего модуля → проверить все импорты
- Изменение функции, используемой в других местах → найти все вызовы
- Игнорирование обратной совместимости → убедиться, что изменения не ломают текущую логику

---

## Где настроить правила в Cursor

- **User Rules**: Settings → Cursor Settings → Rules for AI  
- Или файл `.cursorrules` в корне проекта  
- Либо `.cursor/rules/` — правила на уровне проекта

Скопируй содержимое этого документа в свои Cursor Rules, чтобы AI следовал тем же соглашениям.

---

*Обновлено: 2026-02-24*
